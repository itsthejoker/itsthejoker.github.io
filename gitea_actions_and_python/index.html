<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Gitea Actions, Python, and Debian - Joe Kaufeld</title><meta name=Description content="Personal writing, projects, and thoughts galore."><meta property="og:title" content="Gitea Actions, Python, and Debian"><meta property="og:description" content="Using Debian runners on the all-new Gitea Actions is great! &mldr;Until you want to run Python jobs. Here&rsquo;s how to fix it!"><meta property="og:type" content="article"><meta property="og:url" content="https://itsthejoker.github.io/gitea_actions_and_python/"><meta property="og:image" content="https://itsthejoker.github.io/images/me.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-23T09:47:27-04:00"><meta property="article:modified_time" content="2023-03-23T11:15:14-04:00"><meta property="og:site_name" content="Joe Kaufeld"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://itsthejoker.github.io/images/me.jpg"><meta name=twitter:title content="Gitea Actions, Python, and Debian"><meta name=twitter:description content="Using Debian runners on the all-new Gitea Actions is great! &mldr;Until you want to run Python jobs. Here&rsquo;s how to fix it!"><meta name=application-name content="Joe Kaufeld"><meta name=apple-mobile-web-app-title content="Joe Kaufeld"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://itsthejoker.github.io/gitea_actions_and_python/><link rel=prev href=https://itsthejoker.github.io/3ds-and-usbc/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Gitea Actions, Python, and Debian","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/itsthejoker.github.io\/gitea_actions_and_python\/"},"image":[{"@type":"ImageObject","url":"https:\/\/itsthejoker.github.io\/images\/me.jpg","width":2542,"height":2363}],"genre":"posts","keywords":"gitea-1.19.0, gitea actions, debian, python","wordcount":1202,"url":"https:\/\/itsthejoker.github.io\/gitea_actions_and_python\/","datePublished":"2023-03-23T09:47:27-04:00","dateModified":"2023-03-23T11:15:14-04:00","license":"All rights reserved.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Joe Kaufeld"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Joe Kaufeld">Joe Kaufeld</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/software_and_media>Software & Media </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/series/>Series </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Joe Kaufeld">Joe Kaufeld</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/software_and_media title>Software & Media</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/series/ title>Series</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Gitea Actions, Python, and Debian</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://joekaufeld.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Joe Kaufeld</a></span>&nbsp;<span class=post-category>included in <a href=/categories/projects/><i class="far fa-folder fa-fw" aria-hidden=true></i>projects</a></span></div><div class=post-meta-line></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-03-23>2023-03-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1202 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#gitea-actions---the-new-self-hosted-ci>Gitea Actions - the new self-hosted CI</a></li><li><a href=#the-setup>The Setup</a></li><li><a href=#the-problem>The Problem</a></li></ul></nav></div></div><div class=content id=content><h2 id=gitea-actions---the-new-self-hosted-ci>Gitea Actions - the new self-hosted CI</h2><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden=true></i>Hey, you in the future!<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>I don&rsquo;t intend to update this as time goes on, so if you&rsquo;re reading this far from when it was written, just know that it might be out of date. Use your best judgement!</div></div></div><p>As of the brand new Gitea 1.19.0, Gitea <a href=https://blog.gitea.io/2023/03/gitea-1.19.0-is-released/ target=_blank rel="noopener noreffer">finally has a built-in Actions system!</a> It&rsquo;s intentionally very close to GitHub Actions, meaning that many of the yaml files you&rsquo;ve carefully built up over the years will just work out of the box! And for the most part, that&rsquo;s what happens&mldr; but since this is a new system, there are always some rough spots.</p><p>In this case, the question is &ldquo;what happens if you try to run the GitHub <code>setup-python</code> action on a Debian runner?&rdquo;</p><blockquote><p>Tl;dr: it explodes in a very confusing way. Let&rsquo;s dive into that.</p></blockquote><p>(Want to skip to the important bits? <a href=#the-problem rel>Click here!</a>)</p><h2 id=the-setup>The Setup</h2><p>I run Gitea on my local <a href=https://unraid.net/ target=_blank rel="noopener noreffer">Unraid</a> server in Docker, which has a single VM set aside to act as the runner. Actually getting the runner set up was pretty great - <a href=https://gitea.com/gitea/act_runner target=_blank rel="noopener noreffer">the full instructions are here</a>, but here&rsquo;s the basics.</p><p>On Gitea, you&rsquo;ll need to start by enabling Actions. This is deceptively simple, but does require editing the <code>app.ini</code> file. Just drop this anywhere in it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[actions]</span>
</span></span><span class=line><span class=cl><span class=na>ENABLE</span> <span class=o>=</span> <span class=s>true</span>
</span></span></code></pre></td></tr></table></div></div><p>Restart Gitea and you should see a new option, <code>Runners</code>, in the Site Administration section.</p><p><figure><a class=lightgallery href=/images/gitea_runners_header.png title="A screenshot showing part of the Gitea admin navbar; &amp;ldquo;Applications, Runners, Configuration&amp;rdquo;." data-thumbnail=/images/gitea_runners_header.png data-sub-html="<h2>Should appear in this general location.</h2><p>A screenshot showing part of the Gitea admin navbar; &amp;ldquo;Applications, Runners, Configuration&amp;rdquo;.</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/gitea_runners_header.png data-srcset="/images/gitea_runners_header.png, /images/gitea_runners_header.png 1.5x, /images/gitea_runners_header.png 2x" data-sizes=auto alt=/images/gitea_runners_header.png width=340 height=100></a><figcaption class=image-caption>Should appear in this general location.</figcaption></figure></p><p>After that, you&rsquo;re good to start on building the runner, and that general process is going to look like this:</p><ul><li>Build and update your VM</li><li>Install Docker CE on the runner</li><li>Grab the precompiled binary and drop it in the home folder</li></ul><p>I renamed the precompiled binary to <code>act_runner</code> just to make the rest of the steps easy, but after <a href=https://gitea.com/gitea/act_runner#quickstart target=_blank rel="noopener noreffer">registering the runner</a>, you should be able to run it manually (<code>act-runner daemon</code>) and see it pop up in the Gitea runners list!</p><p><figure><a class=lightgallery href=/images/gitea_runners.png title="A screenshot showing that Gitea has one idle runner." data-thumbnail=/images/gitea_runners.png data-sub-html="<h2>Awesome! One runner, ready and waiting for a job!</h2><p>A screenshot showing that Gitea has one idle runner.</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/gitea_runners.png data-srcset="/images/gitea_runners.png, /images/gitea_runners.png 1.5x, /images/gitea_runners.png 2x" data-sizes=auto alt=/images/gitea_runners.png width=1152 height=206></a><figcaption class=image-caption>Awesome! One runner, ready and waiting for a job!</figcaption></figure></p><p>At this point, there&rsquo;s only one more thing you have to do &ndash; because this is still technically a beta feature, Actions have to be enabled on a <em>per-repo</em> basis. Go to the repo that you want to test with and go to Settings > Repository > Advanced Settings. Buried in the many options there, you&rsquo;ll find this one for Actions &ndash; enable it and click the save button at the bottom of the section.</p><p><figure><a class=lightgallery href=/images/gitea_repo_actions_checkbox.png title="A screenshot showing the group of options that includes enabling Actions." data-thumbnail=/images/gitea_repo_actions_checkbox.png data-sub-html="<h2>Sometimes it's hard to find, but it'll be there.</h2><p>A screenshot showing the group of options that includes enabling Actions.</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/gitea_repo_actions_checkbox.png data-srcset="/images/gitea_repo_actions_checkbox.png, /images/gitea_repo_actions_checkbox.png 1.5x, /images/gitea_repo_actions_checkbox.png 2x" data-sizes=auto alt=/images/gitea_repo_actions_checkbox.png width=423 height=185></a><figcaption class=image-caption>Sometimes it's hard to find, but it'll be there.</figcaption></figure></p><p>Now that we have all the pieces in place, we can finally test some actions! You should be able to use pretty much any GHA file (and Gitea will recognize files in both <code>.github/workflows/*.yaml</code> and <code>.gitea/workflows/*.yaml</code>), but start with a simple one. Since pretty the majority of my projects are in Python, I started with this existing release script for a Python-based system utility I wrote for myself:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Release</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>permissions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>contents</span><span class=p>:</span><span class=w> </span><span class=l>write</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>lsb_release -i -r -s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>lsb_release -i -r -s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/actions/setup-python@v4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>python-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.11.x&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install Env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># this should be all we need because shiv will download the deps itself</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      pip install --upgrade pip
</span></span></span><span class=line><span class=cl><span class=sd>      pip install shiv
</span></span></span><span class=line><span class=cl><span class=sd>      pip install poetry</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Add CURRENT_TIME env property</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>echo &#34;CURRENT_TIME_VERSION=v$(date &#39;+%s&#39;)&#34; &gt;&gt; $GITHUB_ENV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build the sucker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>      sed -i -e &#34;s/?????/${{ env.CURRENT_TIME_VERSION }}/g&#34; src/__init__.py
</span></span></span><span class=line><span class=cl><span class=sd>      make build</span><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/ncipollo/release-action@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>artifacts</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;utils&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>body</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;It&#39;s releasin&#39; time&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>generateReleaseNotes</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=l>${{ env.CURRENT_TIME_VERSION }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>commit</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PAT }}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>You&rsquo;ll notice that there&rsquo;s only one change from a standard GHA file &ndash; I&rsquo;ve prepended <code>https://github.com/</code> to each step that uses an external action (and I&rsquo;m not even 100% sure if that&rsquo;s needed, but that was in the examples so I&rsquo;m rolling with it).</p><p>I also had to create a new secret &ndash; since I use the Personal Access Token on GitHub added to the repo on GitHub, I went looking for a suitable replacement on Gitea. I&rsquo;m very pleased to report that not only can repositories hold secrets (as expected) but you can assign secrets to your user account and they&rsquo;ll automatically apply to all your repos! I created a basic token with repository permissions and added it as a user secret called <code>PAT</code> &ndash; that section of the run file works 100% as expected. Bravo, Gitea!</p><p><figure><a class=lightgallery href=/images/gitea_secrets.png title="A screenshot of the account Secrets page in Gitea." data-thumbnail=/images/gitea_secrets.png data-sub-html="<h2>Shh. It's a secret.</h2><p>A screenshot of the account Secrets page in Gitea.</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/gitea_secrets.png data-srcset="/images/gitea_secrets.png, /images/gitea_secrets.png 1.5x, /images/gitea_secrets.png 2x" data-sizes=auto alt=/images/gitea_secrets.png width=1096 height=223></a><figcaption class=image-caption>Shh. It's a secret.</figcaption></figure></p><p>When I went to run this with a push though, something interesting happened: it exploded on the &ldquo;setting up Python&rdquo; step, which I honestly expected to be fairly nondescript. What happened?</p><h2 id=the-problem>The Problem</h2><p>When debugging, the action failed with the following error:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>##[debug]Unable to locate executable file: lsb_release. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.
</span></span></code></pre></td></tr></table></div></div><p>Before we get too deep here, this is a <strong>partial red herring</strong>, but one that will eventually lead us to the real problem. The reason it&rsquo;s a red herring is that the error message is correct, but not for an obvious reason.</p><p>Debian doesn&rsquo;t ship with <code>lsb-release</code>, the package that will let you run the <code>lsb_release</code> command. (You can install it with <code>sudo apt install lsb-release</code>, but that still won&rsquo;t solve the issue.) What it&rsquo;s actually saying is that it can&rsquo;t find <code>lsb_release</code> <em>on the Docker container the runner downloaded</em>. For reasons I don&rsquo;t completely understand, this is not a problem that is solvable by simply installing <code>lsb-release</code> in an earlier step of your workflow file &ndash; it&rsquo;ll still explode with the same error.</p><p>On your runner VM, in the directory where you registered <code>act_runner</code>, there is a hidden file called <code>.runner</code>. If you open that up, you&rsquo;ll see that there is a section called <code>labels</code>, and it (most likely) looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;labels&#34;</span><span class=err>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-latest:docker://node:16-bullseye&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-22.04:docker://node:16-bullseye&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-20.04:docker://node:16-bullseye&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-18.04:docker://node:16-buster&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>node:16</code> containers work well for <em>most</em> things, but for some reason they don&rsquo;t work out of the box for this use case. What we can do is swap out these images for ones that <em>are</em> configured correctly:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;labels&#34;</span><span class=err>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-latest:docker://catthehacker/ubuntu:act-latest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-22.04:docker://catthehacker/ubuntu:act-22.04&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-20.04:docker://catthehacker/ubuntu:act-20.04&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;ubuntu-18.04:docker://catthehacker/ubuntu:act-20.04&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>After you change out the label section, restart the runner and then restart the job through the Gitea interface (or a push to your repo).</p><p><figure><a class=lightgallery href=/images/gitea_build_success.png title="A screenshot of a successful build on Gitea Actions." data-thumbnail=/images/gitea_build_success.png data-sub-html="<h2>Ignore the extra debug 'lsb_release' step!</h2><p>A screenshot of a successful build on Gitea Actions.</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/gitea_build_success.png data-srcset="/images/gitea_build_success.png, /images/gitea_build_success.png 1.5x, /images/gitea_build_success.png 2x" data-sizes=auto alt=/images/gitea_build_success.png width=398 height=452></a><figcaption class=image-caption>Ignore the extra debug 'lsb_release' step!</figcaption></figure></p><p>In a tremendously surprising move, even the release action worked out of the box, successfully pushing a release to my repo with no issues. Now I just have to fix the update checker (since the Gitea API isn&rsquo;t a 1:1 with GitHub&rsquo;s) and we&rsquo;re good to go!</p><p>Major props to the Gitea team for getting this out the door &ndash; I&rsquo;m so excited that it&rsquo;s here and very excited to use it on my repos!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-03-23</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/gitea_actions_and_python/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://itsthejoker.github.io/gitea_actions_and_python/ data-title="Gitea Actions, Python, and Debian" data-via=joekaufeld data-hashtags="gitea-1.19.0,gitea actions,debian,python"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://itsthejoker.github.io/gitea_actions_and_python/ data-hashtag=gitea-1.19.0><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Tumblr" data-sharer=tumblr data-url=https://itsthejoker.github.io/gitea_actions_and_python/ data-title="Gitea Actions, Python, and Debian" data-tags="gitea-1.19.0,gitea actions,debian,python"><i class="fab fa-tumblr fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://itsthejoker.github.io/gitea_actions_and_python/ data-title="Gitea Actions, Python, and Debian"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://itsthejoker.github.io/gitea_actions_and_python/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://itsthejoker.github.io/gitea_actions_and_python/ data-title="Gitea Actions, Python, and Debian"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/gitea-1.19.0/>gitea-1.19.0</a>,&nbsp;<a href=/tags/gitea-actions/>gitea actions</a>,&nbsp;<a href=/tags/debian/>debian</a>,&nbsp;<a href=/tags/python/>python</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/3ds-and-usbc/ class=prev rel=prev title="USB-C for Fun and... Nah, Just Fun"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>USB-C for Fun and... Nah, Just Fun</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://joekaufeld.com target=_blank>Joe Kaufeld</a></span>&nbsp;|&nbsp;<span class=license>All rights reserved.</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://plausible.io/js/plausible.js async defer data-domain=itsthejoker.github.io></script></body></html>